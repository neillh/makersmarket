!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=101)}({101:function(e,t,n){e.exports=n(102)},102:function(e,t){jQuery((function(e){(function(){var t,n={count:0};function i(e){var t;return t=0,(e=parseInt(e.replace(/[^0-9]/g,"")))>0&&(t=parseInt(5*e/100)),t}function r(t,n){if(void 0===n)return!1;var i=function(t){var n=t.split("?"),i=n[0],r=n[1].split("&"),a={};return e.each(r,(function(e,t){var n=t.split("=");a[n[0]]=n[1]})),{hostName:i,urlArray:a}}(t);return e.each(n,(function(e,t){i.urlArray[e]=t})),function(t,n){var i=t+"?",r=[];return e.each(n,(function(e,t){void 0===t&&(t=""),r.push(e+"="+t)})),i+=r.join("&")}(i.hostName,i.urlArray)}function a(t,n,i,a,o){var s=e("#select_translate").val(),u={rate:e("#min_star").val(),countReviews:e("#count_review").val(),translate:"none"===s?"+N+":"+Y+",ignoreImages:e("#ignoreImages").is(":checked"),withPictures:e("#withImage").is(":checked"),uploadImages:e("#uploadImage").is(":checked"),approved:e("#approved").is(":checked"),skip_keywords:e("#skip_keywords").val(),select_translate:s},d=i?r(i,{translate:u.translate,page:t,withPictures:u.withPictures}):"",l={post_id:n,product_id:a,isRu:o,page:t,feedbackUrl:i,countReviews:u.countReviews,withPictures:u.withPictures,uploadImages:u.uploadImages,ignoreImages:u.ignoreImages,approved:u.approved,min_star:u.rate,skip_keywords:u.skip_keywords,select_translate:u.select_translate};if(o){var f=[];window.ADS.aliExtension.sendAliExtension("getReviewProduct",{productid:a,page:t}).then((function(e){var t,n,i=e.reviewInfo.reviews;for(var r in i){var a=i[r];f.push({feedback:a.text,flag:a.country.toUpperCase(),author:a.username,star:a.rating,date:(t=a.date,void 0,n=void 0,{"янв":"01","фев":"02","мар":"03","апр":"04","май":"05","июн":"06","июл":"07","авг":"08","сен":"09","окт":"10","ноя":"11","дек":"12"},n=t.match(/(\d+) (\W+) (\d+) (\d+):(\d+)/im),{"янв":"01","фев":"02","мар":"03","апр":"04","май":"05","июн":"06","июл":"07","авг":"08","сен":"09","окт":"10","ноя":"11","дек":"12"}[n[2]]),images:a.gallery})}c(!1,l,f)}))}else setTimeout((function(){window.ADS.aliExtension.getPage(d).then((function(e){c(e.obj,l,[])}))}),2e3)}function o(){var t=e("#withImage"),n=t.parents(".form-field"),i=e("#uploadImage"),r=i.parents(".form-field");e(document).find("#ignoreImages").is(":checked")?(t.prop("checked")&&t.click(),i.prop("checked")&&i.click(),n.hide(),r.hide()):(n.show(),r.show())}function s(t,n,i){e.ajaxQueue({url:ajaxurl,data:{action:"adsw_action_reviews",ads_action:t,args:n},type:"POST",dataType:"json",success:i})}function c(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=r.post_id,c=r.product_id,l="true"===r.isRu||!0===r.isRu,f=r,p={flag:"",author:"",star:"",feedback:"",date:""},w=[];for(var v in t&&($feedbackList=t.find(".feedback-list-wrap .feedback-item"),$feedbackList.each((function(t,n){var r=[];(p={feedback:"",flag:"",author:"",star:"",date:"",images:[]}).feedback=e(this).find(".buyer-feedback").text(),e(this).find(".buyer-feedback .r-time-new").length&&(p.feedback=e(this).find(".buyer-feedback span:not(.r-time-new)").text()),p.feedback=p.feedback.replace("seller","store"),p.flag=e(this).find(".css_flag").text(),p.author=e(this).find(".user-name").text(),p.star=i(e(this).find(".star-view span").attr("style")),e(this).find(".pic-view-item").each((function(t,n){r.push(e(n).data("src"))}));var o=e(this).find(".r-time");e(this).find(".r-time-new").length&&(o=e(this).find(".r-time-new")),p.date=o.text(),p.images=r,a.push(p)}))),a)w.push(a[v]);if(0!==a.length&&n.count<=f.countReviews){var g={post_id:o,product_id:c,isRu:l,feed_list:ADS.b64EncodeUnicode(JSON.stringify(w)),min_star:f.min_star,withPictures:f.withPictures,uploadImages:f.uploadImages,ignoreImages:f.ignoreImages,approved:f.approved,importedReview:n.count,page:f.page++,feedbackUrl:f.feedbackUrl,count_review:e("#count_review").val(),select_country:JSON.stringify(f.select_country),skip_keywords:f.skip_keywords,select_translate:f.select_translate};s("upload_review",g,u)}else d()}function u(t){var i=t.post_id,r=t.product_id,o="true"===t.isRu||!0===t.isRu;n.count+=t.count,n.count<parseInt(e("#count_review").val())&&t.page<30?a(t.page,i,t.feedbackUrl,r,o):d()}function d(){window.ADS.coverHide(),window.ADS.notify(n.count+" "+e(".info-reviews-text").val(),"success"),window.ADS.btnUnLock(e("#js-reviewSingleImport"))}return{init:function(){t||(t=this,e("body").on("click","#js-reviewSingleImport",(function(t){t.preventDefault(),window.ADS.coverShow(),window.ADS.btnLock(e(this));var n=e('[name="post_ID"]').val();(function(t){var n=e("#supplier").val();return"default"===n?window.ADS.product(t,["productUrl"]).then((function(e){if(e){if(e.productUrl)return e.productUrl;window.ADS.notify("There is no link for review. Please update product","danger")}})):Promise.resolve(n)})(n).then((function(t){window.ADS.aliExtension.productAli(t).then((function(i){var r,o=i.product.feedbackUrl?"https:"+i.product.feedbackUrl.replace(/#038;/g,"").replace(/038;/g,""):"",s=-1!==t.indexOf("aliexpress.ru");(r=e("#select_translate").val(),"none"===r?Promise.resolve(!0):"www"===r?(window.ADS.aliExtension.enableIframe(),window.ADS.aliExtension.getPage("https://www.aliexpress.com/?alidrop=set_global_site").then((function(e){window.ADS.aliExtension.enableAjax();var t=e.obj.find('script:contains("headerConfig")').text().match(/locale: "\w+_(\w+)",/im);return null!==t&&"US"===t[1].toUpperCase()}))):window.ADS.aliExtension.getPage("https://www.aliexpress.com/").then((function(e){return window.ADS.aliExtension.enableAjax(),window.ADS.aliExtension.getPage("https://"+r+".aliexpress.com").then((function(e){var t=e.obj.find('script:contains("headerConfig")').text().match(/locale: "\w+_(\w+)",/im);if(null===t)return!1;var n=t[1].toUpperCase();return function(e,t){e=e.toUpperCase(),t=t.toUpperCase();var n={WWW:"US",PT:"BR",RU:"RU",ES:"ES",FR:"FR",PL:"PL",HE:"IW",IT:"IT",TR:"TR",DE:"DE",KO:"KR",AR:"MA"};return void 0!==n[e]&&n[e]===t}(r,n)}))}))).then((function(t){t?a(1,n,o,i.product.id,s):(window.ADS.notify(e("#info-lan").text(),"danger"),window.ADS.coverHide(),window.ADS.btnUnLock(e(this)))}))}))}))})),e("body").on("click","#ignoreImages",(function(){o()})),o())}}})().init()}))}});