(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{1112:function(e,t,a){"use strict";a.r(t);var r=a(0),c=a(4),n=a(2),s=a(5),m=a(12),i=a.n(m),o=a(784),l=a(793),b=a(48),w=a.n(b),p=a(3),u=a(820),d=a(135),O=a(63),f=a(8),j=a(128),g=a(127);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function E(e,t,a,r,c,n,s){try{var m=e[n](s),i=m.value}catch(e){return void a(e)}m.done?t(i):Promise.resolve(i).then(r,c)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,c=!1,n=void 0;try{for(var s,m=e[Symbol.iterator]();!(r=(s=m.next()).done)&&(a.push(s.value),!t||a.length!==t);r=!0);}catch(e){c=!0,n=e}finally{try{r||null==m.return||m.return()}finally{if(c)throw n}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}t.default=function(e){var t=Object(r.useContext)(s.d),a=_(Object(r.useState)(!1),2),m=a[0],b=a[1],y=_(Object(r.useState)(1),2),h=y[0],N=y[1],k=_(Object(r.useState)(""),2),C=k[0],S=k[1],P=_(Object(r.useState)({loading:!1,error:!1,success:!1,message:""}),2),T=P[0],x=P[1],M=_(Object(r.useState)(!1),2),D=M[0],I=M[1],A=_(Object(r.useState)(!1),2),H=A[0],B=A[1],Y=_(Object(r.useState)({}),2),L=Y[0],R=Y[1],F={rich:Object(n.__)("Rich Text","wp-marketing-automations"),wc:Object(n.__)("WooCommerce","wp-marketing-automations"),html:Object(n.__)("HTML","wp-marketing-automations"),editor:Object(n.__)("Editor","wp-marketing-automations")},U=_(Object(r.useState)({message:"",type:1}),2),q=U[0],G=U[1],K=Object(l.a)().setCampaignValues,J=Object(s.q)(),V=o.a.getCampaignData(),z=o.a.getCampaignId(),W=(o.a.getEditableMode(),parseInt(V.type));Object(r.useEffect)((function(){if(V)if(V.hasOwnProperty("execution_time")&&!Object(p.isNull)(V.execution_time))N(2),S(w()(Object(s.K)(V.execution_time,!0,!0,!1)).format("YYYY-MM-DDTHH:mm:ss"));else{var e=Object(s.w)(w()(new Date)).format("YYYY-MM-DDTHH:mm:ss");S(e)}}),[]),Object(r.useEffect)((function(){document.addEventListener("click",(function(e){var t=document.getElementsByClassName("bwf-crm-campaign-schedule-popover")[0],a=!0;void 0!==t&&t.contains(e.target)&&(a=!1),m&&"bwf-crm-campaign-review-schedule-text-box"!=e.target.id&&a&&b(!1)}))}));var Z=Object(g.a)().setL2Title;Object(r.useEffect)((function(){Z("title"in V?Object(r.createElement)(r.Fragment,null,V.title):"")}),[V]);var $,Q,X,ee=V?V.count:0,te=[{value:1,className:"bwf-crm-campaign-schedule bwf-crm-campaign-schedule-now",label:Object(n.__)("Broadcast Now","wp-marketing-automations")},{value:2,className:"bwf-crm-campaign-schedule bwf-crm-campaign-schedule-later",label:Object(n.__)("Schedule For Later","wp-marketing-automations")}],ae=function(){var a,r=(a=regeneratorRuntime.mark((function a(){var r,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setPending(!0),!(ee<=0)){a.next=5;break}return x({status:!0,error:Object(n.__)("No Contacts are selected.","wp-marketing-automations")}),e.setPending(!1),a.abrupt("return");case 5:if(r=Object(s.w)(w()(new Date)).format("YYYY-MM-DDTHH:mm:ss"),c=Object(s.w)(w()(C)),2!=h||c.isAfter(r)||c.isSame(r,"minute")){a.next=11;break}return x({status:!0,error:Object(n.__)("Given time should exceeds the current time.","wp-marketing-automations")}),e.setPending(!1),a.abrupt("return");case 11:return a.prev=11,a.next=14,i()({path:Object(s.k)("/broadcast/".concat(z)),method:"POST",data:{data:{schedule_time:2==h?Object(s.y)(C).utc().format():"",modified_by:Object(s.u)()},step:4},headers:{"Content-Type":"application/json"}}).then((function(e){200==e.code?(t(e.message),Object(s.Z)(t,2e3),setTimeout((function(){K("data",e.result),K("editableMode",!1)}),2e3)):x({status:!0,error:e.message})}));case 14:a.next=19;break;case 16:a.prev=16,a.t0=a.catch(11),x({status:!0,error:a.t0.message});case 19:e.setPending(!1);case 20:case"end":return a.stop()}}),a,null,[[11,16]])})),function(){var e=this,t=arguments;return new Promise((function(r,c){var n=a.apply(e,t);function s(e){E(n,r,c,s,m,"next",e)}function m(e){E(n,r,c,s,m,"throw",e)}s(void 0)}))});return function(){return r.apply(this,arguments)}}();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(O.a,null),Object(r.createElement)("div",{className:"bwf-campaign-step-div bwf-card-wrap bwf-campaign-step-4"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(r.createElement)("span",{className:"bwf-form-title"},Object(n.__)("Review & Schedule","wp-marketing-automations"))),Object(r.createElement)("div",{className:""},Object(r.createElement)("div",{className:"bwf-p-gap bwf-top-gap"},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Information","wp-marketing-automations")),Object(r.createElement)(c.CardBody,{className:"bwf-crm-overview-report-body"},Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Title","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-report-row-value"},V.title)),Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Type","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-report-row-value"},J[W].label)),!!V.description&&Object(r.createElement)("div",{className:"bwf-report-row",key:3},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Description","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-report-row-value"},V.description)))))),Object(r.createElement)("div",{className:"bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap "},Object(r.createElement)(r.Fragment,null,Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Contacts","wp-marketing-automations")),Object(r.createElement)(c.CardBody,{className:"bwf-crm-overview-report-body"},Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Total","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Object(r.createElement)("b",null,ee))),V.data.hasOwnProperty("filters")&&!Object(p.isEmpty)(V.data.filters)&&Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Segments","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-report-row-value"},Object(u.b)(V.data.filters)))))))),Object(r.createElement)("div",{className:" bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap "},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Content","wp-marketing-automations")),Object(r.createElement)(c.CardBody,{className:"bwf-crm-overview-report-body"},W&&1==W&&V.data.hasOwnProperty("senders_name")&&!Object(p.isEmpty)(V.data.senders_name)&&Object(r.createElement)("div",{className:"bwf-report-row",key:1},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("From Name","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-report-row-value"},V.data.senders_name)),W&&1==W&&V.data.hasOwnProperty("senders_email")&&!Object(p.isEmpty)(V.data.senders_email)&&Object(r.createElement)("div",{className:"bwf-report-row",key:2},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("From Email","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-report-row-value"},V.data.senders_email)),W&&1==W&&V.data.hasOwnProperty("replyto")&&!Object(p.isEmpty)(V.data.replyto)&&Object(r.createElement)("div",{className:"bwf-report-row",key:3},Object(r.createElement)("div",{className:"bwf-report-row-label"},Object(n.__)("Reply-To Email","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-report-row-value"},V.data.replyto)),V.data&&V.data.content&&V.data.content.map((function(e,t){return Object(r.createElement)("div",{className:"bwf-report-row",key:t},Object(r.createElement)("div",{className:"bwf-report-row-label"},V.data.content.length>1?Object(n.__)("Content #","wp-marketing-automations")+(parseInt(t)+1):Object(n.__)("Content","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-report-row-value bwf-report-value-modal"},W&&e.subject&&Object(r.createElement)("span",null,e.subject),Object(r.createElement)(c.Button,{isSecondary:!0,className:"bwf-a-no-underline",style:{height:"auto",padding:"10px 20px"},onClick:function(){B(!0),[2,3].includes(parseInt(W))?I(!0):I(!1),R(e)}},Object(n.__)("View details","wp-marketing-automations"))))})),H&&Object(r.createElement)(c.Modal,{onRequestClose:function(){return B(!1)},className:"bwf-message-preview-modal bwf-admin-modal bwf-admin-modal-large bwf-h--core-header"},Object(r.createElement)("div",{className:"bwf-modal-header"},Object(r.createElement)("div",{className:"bwf-modal-heading"},Object(n.__)("Details","wp-marketing-automations")),Object(r.createElement)("span",{onClick:function(){return B(!1)},className:"bwf-modal-close"},Object(r.createElement)(f.a,{icon:"close",color:"#353030"}))),($=L,Q="",X=!0,3==W&&$.hasOwnProperty("whatsAppImage")&&$.whatsAppImage&&$.hasOwnProperty("whatsAppImageSetting")&&$.whatsAppImageSetting.hasOwnProperty("position")&&!Object(p.isEmpty)($.whatsAppImageSetting.position)&&$.whatsAppImageSetting.hasOwnProperty("imageURL")&&!Object(p.isEmpty)($.whatsAppImageSetting.imageURL)&&(Q="before"===$.whatsAppImageSetting.position?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("img",{src:$.whatsAppImageSetting.imageURL,width:50,height:50}),Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:$.body}})):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:$.body}}),Object(r.createElement)("img",{src:$.whatsAppImageSetting.imageURL,width:50,height:50})),X=!1),X&&(Q=Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:"editor"===$.type?$.editor.body:$.body}})),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-message-wrap"},Object(r.createElement)("div",{className:"bwf-section"},1==W&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Subject","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},$.subject)),1==W&&$.hasOwnProperty("preheader")&&!Object(p.isEmpty)($.preheader)&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Mail Pre-header","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},$.preheader)),1==W&&$.hasOwnProperty("type")&&!Object(p.isEmpty)($.type)&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("Mail Type","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},F[$.type])),$.hasOwnProperty("utm")&&!Object(p.isEmpty)($.utm)&&function(e){var t=[];return t.push(Object(n.__)("Source","wp-marketing-automations")+": "+e.source),t.push(Object(n.__)("Medium","wp-marketing-automations")+": "+e.medium),e.hasOwnProperty("name")&&!Object(p.isEmpty)(e.name)&&t.push(Object(n.__)("Name","wp-marketing-automations")+": "+e.name),e.hasOwnProperty("content")&&!Object(p.isEmpty)(e.content)&&t.push(Object(n.__)("Content","wp-marketing-automations")+": "+e.content),e.hasOwnProperty("term")&&!Object(p.isEmpty)(e.term)&&t.push(Object(n.__)("Term","wp-marketing-automations")+": "+e.term),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-210 bwf_bold bwf_align_center"},Object(n.__)("UTM Details","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},Object(r.createElement)("div",{className:"bwf-p"},t.join(" | "))))}($.utm),D&&Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-report-row-value"},Q)),Object(r.createElement)("div",{className:"bwf-p-15 bwf-t-center"},Object(r.createElement)("a",{className:"bwf-model-link",onClick:function(){return I(!D)}},D?Object(n.__)("Less Details","wp-marketing-automations"):Object(n.__)("More Details","wp-marketing-automations")))))))))))),Object(r.createElement)("div",{className:"bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-p-gap "},Object(r.createElement)(c.Card,{className:"bwf-crm-overview-detail-wrap"},Object(r.createElement)(c.CardHeader,{className:"bwf-crm-overview-report-header"},Object(n.__)("Schedule","wp-marketing-automations")),Object(r.createElement)(c.CardBody,{className:"bwf-crm-overview-schedule-section"},Object(r.createElement)("div",{className:"bwf-campaign-review-broadcast-wrap",onClick:function(){b(!1)}},Object(r.createElement)(c.ButtonGroup,{className:"bwf-crm-campaign-schedule-btn-grp bwf-alter-button"},te.map((function(e,t){var a=e.value===h?{isPrimary:!0}:{isSecondary:!0};return Object(r.createElement)(c.Button,v({onClick:function(){N(e.value)}},a,{className:e.className,key:t}),1==e.value?Object(r.createElement)(f.a,{icon:"broadcasts",color:e.value===h?"#fff":"#000"}):Object(r.createElement)(f.a,{icon:"timer",color:e.value===h?"#fff":"#000"}),e.label)}))),2==h&&Object(r.createElement)("div",{className:"bwf-crm-campaign-review-date-wrap"},Object(r.createElement)("div",null,Object(r.createElement)("span",{className:"bwf-mr-5"},Object(r.createElement)(f.a,{icon:"calender"})),Object(n.__)("Pick Date and Time","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-crm-campaign-review-schedule-text-box",id:"bwf-crm-campaign-review-schedule-text-box",onClick:function(e){e.stopPropagation(),b(!m)}},Object(s.K)(w()(C),!1,!1)),m&&Object(r.createElement)("div",{className:"bwf-crm-campaign-schedule-popover",onClick:function(e){return e.stopPropagation()}},Object(r.createElement)(c.DateTimePicker,{currentDate:C,isInvalidDate:function(e){return Object(s.w)(e).isBefore(Object(s.w)(w()()),"day")},onChange:function(e,t){var a=Object(s.w)(w()(new Date)).format("YYYY-MM-DDTHH:mm:ss"),r=Object(s.w)(w()(e));r.isAfter(a)||r.isSame(a,"minute")?S(e):G({message:Object(n.__)("Given time should exceeds the current time.","wp-marketing-automations"),type:0})},is12Hour:!0}),Object(r.createElement)("div",{className:"bwf-p bwf-display-flex"},"Current Store Time: ",Object(s.K)(w()().tz("UTC")))))))))),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-crm-campaign-navigation"},Object(r.createElement)(c.Button,{isSecondary:!0,className:"bwf-crm-navigation-previous",onClick:function(){K("step",3)}},Object(n.__)("Previous","wp-marketing-automations")),Object(r.createElement)(c.Button,{className:"bwf-crm-navigation-next",isPrimary:!0,onClick:function(){ae()},isBusy:e.isPending},1===h?Object(n.__)("Send Now","wp-marketing-automations"):Object(n.__)("Schedule","wp-marketing-automations")))),Object(r.createElement)(j.a,{modalTitle:Object(n.__)("Update Broadcast"),confirmText:T.confirmText,deleteEntityName:T.deleteEntityName,confirmButtonText:T.buttonConfirm,cancelButtonText:T.buttonCancel,onConfirm:T.onConfirm,isLoading:T.loading,successMessage:T.success,errorMessage:T.error,onRequestClose:function(){return x({status:!1})},isOpen:T.status,isDelete:!0}),Object(r.createElement)(d.a,{message:q.message,type:q.type,removeMessage:function(){return G({message:"",type:1})}})))}}}]);