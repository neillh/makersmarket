(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1190:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(4),c=n(2),o=n(12),l=n.n(o),i=n(3),s=n(816),u=n(810),b=n(137),f=n(5),m=n(15),d=n(64),p=n(16),O=n(258),j=n(36),y=n(241),g=n(8),v=n(239),w=n(6),h=n.n(w),E=n(804),_=n(795),k=n(247);function P(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,c=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,c=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw c}}return n}(e,t)||S(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=Object(d.a)(Object(f.U)()).formatAmount,A=function(e){var t=e.setContactCount,n=e.excludedIds,o=void 0===n?[]:n,l=e.setExcluded,s=function(e){var t=Object(i.isEmpty)(e.country)?"":k[e.country],n=Object(f.rb)([e.city,e.state,t],", ");return Object(i.isEmpty)(Object(i.trim)(n))?"":n},u=function(e){var t=s(e);return e.country||t?Object(r.createElement)(p.a,{justify:"start"},!Object(i.isEmpty)(e.country)&&Object(r.createElement)(p.c,null,Object(r.createElement)(O.a,{code:e.country,size:18})),Object(r.createElement)(p.c,null,t&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("span",null,s(e)),Object(r.createElement)("br",null)))):"-"},b=function(e){return Object(r.createElement)(j.a,{href:"admin.php?page=autonami&path=/contact/"+e.id,className:"bwf-a-no-underline"},Object(r.createElement)(y.a,{contact:e,hideJoiningDate:!0}))},m=function(e){return Object(r.createElement)("div",{className:"bwf-c-contact-details-cell"},e.email&&Object(r.createElement)(p.a,{justify:"start",align:"top"},Object(r.createElement)(p.c,null,Object(r.createElement)(g.a,{icon:"mail"})),Object(r.createElement)(p.c,null,Object(r.createElement)(j.a,{href:"mailto:"+e.email,className:"bwf-a-no-underline",type:"external"},e.email))),e.phone&&Object(r.createElement)(p.a,{justify:"start",align:"top"},Object(r.createElement)(p.c,null,Object(r.createElement)(g.a,{icon:"phone"})),Object(r.createElement)(p.c,null,Object(r.createElement)(j.a,{href:"tel:"+e.phone,className:"bwf-a-no-underline",type:"external"},e.phone))))},d=Object(E.a)(),w=d.getPageNumber,S=d.getPerPageCount,x=d.getTotalCount,A=d.getLoading,C=d.getContacts,D=Object(_.a)().fetch,L=e.query,q=C(),T=w(),F=S(),R=x(),B=A(),G=N(Object(r.useState)(!0),2),J=G[0],M=G[1];Object(r.useEffect)((function(){J&&R>0&&M(!1),t(parseInt(R))}),[R]);var U=[{cellClassName:"is-checkbox-column",key:"id",label:"",required:!0},{key:"contact",label:Object(c.__)("Contact","wp-marketing-automations"),isLeftAligned:!0,required:!0},{key:"contact_details",label:Object(c.__)("Details","wp-marketing-automations"),isLeftAligned:!0}];Object(f.qb)()?(U.push({key:"total_spent",label:Object(c.__)("Total Spent","wp-marketing-automations"),isLeftAligned:!0}),U.push({key:"last_order",label:Object(c.__)("Last Order","wp-marketing-automations"),isLeftAligned:!0})):U.push({key:"column_location",label:Object(c.__)("Location","wp-marketing-automations"),isLeftAligned:!0});var $=function(e){var t=e.wc,n=t.total_order_count,a=t.total_order_value;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-listing-total-spent"},a&&n?Object(r.createElement)("div",{className:"bwf-c-total-spent-amount"},I(a)," |"," ",n," ",Object(c.__)(parseInt(n)>1?"orders":"order","wp-marketing-automations")):"-"))},z=function(e){var t=e.wc.l_order_date;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",null,t&&"0000-00-00"!=t?Object(r.createElement)("div",{className:"bwf-c-total-spent-amount"},Object(f.J)(t)):"-"))},Q=q.map((function(e){var t=function(e){return Object(i.merge)({id:0,email:"-",first_name:"",last_name:"",creation_date:"",fields:{marketing_status:"0",first_order_date:"",country:"",city:"",state:"",phone:""},wc:{id:1,l_order_date:"",total_order_count:0,total_order_value:0,total_purchased_items:0}},e)}(e),n=[{display:Object(r.createElement)(a.CheckboxControl,{onChange:function(e){return n=t.id,void l(e?o.filter((function(e){return e!==n})):[].concat(P(o),[n]));var n},"aria-label":Object(c.__)("Select"),checked:-1===o.indexOf(t.id)}),value:t.id},{display:b(t),value:Object(f.rb)([t.first_name,t.last_name]," ")},{display:m(t),value:Object(c.__)("Email: "+t.email+", Phone: "+t.phone,"wp-marketing-automations")}];return Object(f.qb)()?(n.push({display:$(t),value:""}),n.push({display:z(t),value:""})):n.push({display:u(t),value:s(t)}),n})),V=function(e){e!==F&&D(L,0,e,!0,!1,"",!1)},H=h()("bwfcrm-contacts-list",{"has-search":!0}),K=parseInt(R)>0?" ("+(parseInt(R)-parseInt(o.length))+")":"";return Object(r.createElement)(v.a,{className:H,title:Object(c.__)("Contacts ","wp-marketing-automations")+K,rows:Q,headers:U,query:{paged:T},rowsPerPage:F,totalRows:R,isLoading:B,onPageChange:function(e,t){D(L,(e-1)*F,F)},onQueryChange:function(e){return"per_page"!==e?function(){}:V},showMenu:!1,emptyMessage:Object(c.__)("No contacts found","wp-marketing-automations")})};A.defaultProps={contacts:[]};var C=A,D=n(803),L=n(808),q=n(142),T=n(63);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e,t,n,r,a,c,o){try{var l=e[c](o),i=l.value}catch(e){return void n(e)}l.done?t(i):Promise.resolve(i).then(r,a)}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,c=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,c=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function U(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}t.default=function(e){var t=e.bulkActionId,n=e.setStep,o=e.setPending,d=e.isPending,p=Object(u.a)(),O=Object(m.i)(),j=O.page,y=O.path,g=U(O,["page","path"]),v=Object(_.a)(),w=J(Object(r.useState)(!0),2),h=w[0],E=w[1],k=J(Object(r.useState)(!1),2),P=k[0],N=k[1],S=J(Object(r.useState)(""),2),x=S[0],I=S[1],A=Object(D.a)().setSingleBulkActionValue,F=Object(L.a)(),B=F.getSingleBulkActionData,M=F.getSingleBulkActionLoad,$=B(),z=M(),Q=$.contactFilters,V=void 0===Q?{}:Q,H=$.count,K=void 0===H?0:H,W=$.exclude_ids,X=void 0===W?[]:W;Object(r.useEffect)((function(){z||(Object(i.isEmpty)(V)||Object(m.k)(V,"/",O),E(!1))}),[V]);var Y=v.fetch;Object(r.useEffect)((function(){P||Y(g,0,10,!0,!1,"",!1)}),[location.search]);var Z=function(){var e,r=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o(!0),N(!0),e.next=5,l()({path:Object(f.k)("/bulk-action/".concat(t)),method:"POST",data:R(R({},$),{},{contactFilters:g,exclude_ids:X,count:parseInt(K)-parseInt(X.length)})}).then((function(e){200==e.code?e.hasOwnProperty("result")&&!Object(i.isEmpty)(e.result)&&(A("data",e.result),setTimeout((function(){N(!1),n(2),Object(m.k)({page:j,path:y},"/",{}),o(!1)}),1e3)):(I(e.message),N(!1),o(!1))}));case 5:e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),I(e.t0.message),o(!1),N(!1);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var c=e.apply(t,n);function o(e){G(c,r,a,o,l,"next",e)}function l(e){G(c,r,a,o,l,"throw",e)}o(void 0)}))});return function(){return r.apply(this,arguments)}}(),ee=Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-card-wrap"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(c.__)("Contacts","wp-marketing-automations-crm"))),Object(r.createElement)("div",{className:"bwf-bulk-action-step-loading bwf-p-20"},Object(r.createElement)("div",{className:"bwf-filter-placeholder "},Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",{className:"bwf-w-150"},Object(r.createElement)("div",{className:"bwf-placeholder-temp"})),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"})),Object(r.createElement)("div",{className:"bwf-w-300 bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",{className:"bwf-placeholder-temp"})),Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",null),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"})),Object(r.createElement)("div",{className:"bwf_clear_20"})),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-w-150"},Object(r.createElement)("div",{className:"bwf-placeholder-temp"})),Object(r.createElement)(q.a,{numberOfRows:10,headers:[{key:"2",label:Object(r.createElement)("div",{className:"bwf-w-210"},Object(r.createElement)("div",{className:"bwf-placeholder-temp no-margin"}))},{key:"3",label:Object(r.createElement)("div",{className:"bwf-w-210"},Object(r.createElement)("div",{className:"bwf-placeholder-temp no-margin"}))},{key:"4",label:Object(r.createElement)("div",{className:"bwf-w-210"},Object(r.createElement)("div",{className:"bwf-placeholder-temp no-margin"}))}]}),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-bulk-action-footer"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between"},Object(r.createElement)("div",null),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"})))));return!0===p||h?ee:Object(r.createElement)(r.Fragment,null,Object(r.createElement)(T.a,null),Object(r.createElement)("div",{className:"bwf-card-wrap"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(c.__)("Contacts","wp-marketing-automations-crm"))),Object(r.createElement)("div",{className:"bwf-bulk-action-wrapper"},x&&Object(r.createElement)(a.Notice,{status:"error",onRemove:function(){return I("")}},x),Object(r.createElement)("div",{className:"bwf-bulk-action-contact-filter"},Object(r.createElement)("div",{className:"bwf-display-flex",style:{justifyContent:"space-between"}},Object(r.createElement)("div",{className:"bwf-h3 bwf-w-300"},Object(c.__)("Segment Contacts","wp-marketing-automations-crm")),Object(r.createElement)(s.c,{addAdvance:!1})),Object(r.createElement)("div",{className:"bwf-p-0"},Object(r.createElement)(b.a,{siteLocale:"en-US",currency:Object(f.qb)()?bwfcrm_contacts_data.currency:{},config:{title:Object(c.__)("Select Rules","wp-marketing-automations-crm"),filters:p,footerComponent:function(e){return Object(r.createElement)(s.a,{filter:e.data,config:e.config})},enableGrouping:!0},path:"/bulk-action/".concat(t),query:O,onAdvancedFilterAction:function(e,t){["filter","remove","clear_all"].includes(e)&&A("data",R(R({},$),{},{exclude_ids:[]}))}}))),Object(r.createElement)("div",{className:"bwf-bulk-action-table-wrapper"},Object(r.createElement)(C,{setContactCount:function(e){A("data",R(R({},$),{},{count:parseInt(e)}))},excludedIds:X,setExcluded:function(e){A("data",R(R({},$),{},{exclude_ids:e}))},query:g}))),Object(r.createElement)("div",{className:"bwf-bulk-action-footer"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between"},Object(r.createElement)("div",null),Object(r.createElement)(a.Button,{className:"bwf-display-flex",isPrimary:!0,onClick:function(){K>0?Z():I(Object(c.__)("Please select some contacts to perform bulk actions on them.","wp-marketing-automations-crm"))},isBusy:d},Object(c.__)("Next","wp-marketing-automations-crm")))))}},795:function(e,t,n){"use strict";var r=n(129),a=n(5);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}t.a=function(){var e=Object(r.a)("contacts"),t=e.fetch;return o(o({},i(e,["fetch"])),{},{fetch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],b=arguments.length>8&&void 0!==arguments[8]&&arguments[8],f=e.s,m=void 0===f?"":f,d=(e.page,e.filter,e.orderby),p=e.order,O=(e.path,i(e,["s","page","filter","orderby","order","path"])),j={offset:n,limit:r,search:m,filters:O,get_wc:Object(a.qb)(),grab_totals:c,only_count:o,fetch_base:l,grab_custom_fields:!1,exclude_unsubs:s,exclude_unsubs_lists:u};p&&d&&(j.order=p,j.order_by=d),b&&(j.unopen_broadcast=parseInt(b)),t("GET",Object(a.k)("/contacts"),j)},fetchListing:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],b=arguments.length>8&&void 0!==arguments[8]&&arguments[8],f=e.s,m=void 0===f?"":f,d=(e.page,e.filter,e.orderby),p=e.order,O=(e.path,i(e,["s","page","filter","orderby","order","path"])),j={offset:n,limit:r,search:m,filters:O,get_wc:Object(a.qb)(),grab_totals:c,only_count:o,fetch_base:l,grab_custom_fields:!1,exclude_unsubs:s,exclude_unsubs_lists:u};p&&d&&(j.order=p,j.order_by=d),b&&(j.unopen_broadcast=parseInt(b)),t("GET",Object(a.k)("/contacts/listing"),j)},startIndexing:function(){return t("GET",Object(a.k)("/contacts"),{start_indexing:!0})}})}},804:function(e,t,n){"use strict";var r=n(130);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}t.a=function(){var e=Object(r.a)("contacts"),t=e.getStateProp;return c(c({},l(e,["getStateProp"])),{},{getContacts:function(){return t("contacts_list")},getPageNumber:function(){return parseInt(t("offset"))/parseInt(t("limit"))+1},getPerPageCount:function(){return parseInt(t("limit"))},getTotalCount:function(){return parseInt(t("total"))},getCountData:function(){return t("countData")}})}}}]);